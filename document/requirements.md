
# 要件定義（最新版）

## 概要
本アプリは、仮説キャンバス〜仮説展開ストーリー作成までを段階的にAI（OpenAI）と対話しながら進める、プロンプト駆動型の仮説検証支援ツールです。
2026-01時点での主な追加・変更点：
・13ステップの後に「仮説キャンバスまとめ」ステップ（図UI＋AI自動生成）を追加
・15ステップ目として「自由記述」ステップ（履歴を踏まえた自由入力・AI生成）を追加
・全ステップの入力・AI出力・日時をMarkdown/CSV形式で一括エクスポートできる機能を追加（テンプレートはutils/exportTemplates.tsで管理、可視性重視の成形出力、出力枠は右端サイドバー下部に配置）
・全ステップのAI出力履歴を画面右端サイドバーで常時参照可能に
・中央カラム・AI出力の幅調整、サイドバーと重ならないレイアウト
・仮説キャンバス図は部屋分けUIで常時表示、AI生成で内容を穴埋め
・履歴サイドバーはタブ＋カード型で見やすさ向上

## 主な要件
- ユーザーは各プロンプト（prompt1〜prompt13）に沿って入力を行い、全ステップを順に進行できる
- 各ステップの入力・AI出力・実行日時は全てlocalStorageに履歴として保存され、リロード後も復元可能
- ステップ一覧から任意の過去ステップに戻り、入力内容を修正・再実行できる
- 各ステップ実行時、過去の入力・AI出力履歴を文脈としてプロンプトに自動で含めてAIに送信（文脈維持）
- OpenAI APIはサーバーサイドからのみ呼び出し、API Keyは「sk-proj-」で始まるものを.envで管理
- モデル（例: gpt-4, gpt-3.5-turbo等）は.envで設定
- UI上でAPI Key入力欄は不要
- 各プロンプトの内容・出力形式は`仮説キャンバスprompts.md`に準拠
- 14ステップ目「仮説キャンバスまとめ」では、全ステップの内容をもとに部屋分け図UI＋AI自動生成で仮説キャンバスをまとめて表示
- 15ステップ目「自由記述」では、これまでの履歴を踏まえて自由に記述・AI生成できる
- 日本語を基本とする

## 非機能要件
- 拡張性：プロンプトやまとめステップの追加・変更、エクスポートテンプレートのカスタマイズが容易
- セキュリティ：API Keyは公開しない
- 保守性：ドキュメント・設計書をdocument配下にまとめる
